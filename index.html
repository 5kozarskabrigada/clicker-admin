<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clicker Admin Panel</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>

<body>

    <div id="login-container" class="container">
        <h1>Admin Panel Login</h1>
        <div class="action-form">
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="admin@email.com">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password">
            </div>
            <button class="primary-btn" onclick="handleLogin()">Login</button>
            <div id="loginResult"></div>
        </div>
    </div>

    <div id="app-container" class="container" style="display: none;">
        <h1>Coin Clicker Admin Panel</h1>

        <div class="tab-container">
            <button class="tab-link active" onclick="openTab(event, 'users')">Users</button>
            <button class="tab-link" onclick="openTab(event, 'logs')">Logs</button>
            <button class="tab-link" onclick="openTab(event, 'actions')">Actions</button>
        </div>


        <div id="users" class="tab-content active">
            <h2>
                User Management
                <button class="refresh-btn" onclick="loadUsers()">Refresh</button>
            </h2>
            <input type="text" id="searchUser" placeholder="Search username..." oninput="searchUsers()">
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Username</th>
                            <th>Coins</th>
                            <th>Last Online</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="usersList"></tbody>
                </table>
            </div>
        </div>


        <div id="logs" class="tab-content">
            <h2>
                System Logs
                <button class="refresh-btn" onclick="loadLogs()">Refresh</button>
            </h2>
            <div class="form-group">
                <label for="logType">Log Type:</label>
                <select id="logType" onchange="loadLogs()">
                    <option value="admin_logs">Admin Actions</option>
                    <option value="user_logs">User Actions</option>
                </select>
            </div>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Timestamp</th>
                            <th>Action</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody id="logsList"></tbody>
                </table>
            </div>
        </div>


        <div id="actions" class="tab-content">
        <h2>
            Quick Actions
            <button class="refresh-btn" onclick="document.getElementById('actionResult').innerHTML = ''">Clear Status</button>
        </h2>
            <div class="action-form">
                <div class="form-group">
                    <label for="actionUser">Username (without @)</label>
                    <input type="text" id="actionUser" placeholder="">
                </div>
                <div class="form-group">
                    <label for="actionType">Action</label>
                    <select id="actionType">
                        <option value="set_coins">Set Coins</option>
                        <option value="add_coins">Add Coins</option>
                        <option value="ban">Ban User</option>
                        <option value="unban">Unban User</option>
                        <option value="make_admin">Make Admin</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="actionValue">Value</label>
                    <input type="text" id="actionValue" placeholder="Amount or Reason">
                </div>
                <button class="primary-btn" onclick="performAction()">Execute Action</button>
                <div id="actionResult"></div>
            </div>
        </div>
    </div>

    <div id="edit-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="modal-title">Edit User Coins</h2>
            <p id="modal-username"></p>
            <div class="form-group">
                <label for="modal-input">New Coin Amount</label>
                <input type="text" id="modal-input" placeholder="e.g., 0.0000123456">
            </div>
            <div class="modal-actions">
                <button id="modal-cancel-btn" class="secondary-btn">Cancel</button>
                <button id="modal-save-btn" class="primary-btn">Save Changes</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>